The matrix "returns_matrix" corresponds to the matrix "r" in the paper. "prob_outcome_i" is the vector of probabilities of the outcomes "pi".
"pi_k" is the probability of picking the vector of outcomes stores at the k-th row of "returns_matrix".


Please contact me if you have further questions.
--
Antonio Simoes